---
title: decorator
date: 2017-03-01 22:27:55
categories:
  - å†å²
  - ES6
tags:
  - map
  
---

ç®€å•ä»‹ç»ä¸€ä¸‹ decorator

<!--more-->

### decorator æ˜¯ä»€ä¹ˆé¬¼

`ES7`ä¸­çš„`decorator`æ˜¯ä»`Python`è£…æ½¢å™¨å€Ÿæ¥çš„ï¼Œä½œç”¨å°±æ˜¯ï¼Œå®ƒä½œç”¨äºä¸€ä¸ªç›®æ ‡å‡½æ•°ï¼Œå¯¹è¿™ä¸ªå‡½æ•°è¿›è¡Œä¸€äº›é¢å¤–çš„å¤„ç†ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚æœ¬è´¨å…¶å®æ˜¯ä¸€ç§`è¯­æ³•ç³–`ï¼Œä¾èµ–äº`ES5`ä¸­çš„`Object.defineProperty`ã€‚
ä¼ªä»£ç ç¤ºèŒƒï¼š

```bash
@decoratorTest
class A {}
//ä»¥ä¸Šä»£ç å°±ç±»ä¼¼äº
A = decoratorTest(A)||A;
```

### é‚£ä¹ˆ Object.defineProperty åˆæ˜¯ä»€ä¹ˆ ğŸ‘» å‘¢

`Object.defineProperty()` æ–¹æ³•ä¼šç›´æ¥åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šå®šä¹‰ä¸€ä¸ªæ–°å±æ€§ï¼Œæˆ–è€…ä¿®æ”¹ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å±æ€§ï¼Œ å¹¶è¿”å›è¿™ä¸ªå¯¹è±¡ã€‚

è¯­æ³•ï¼š

```bash
Object.defineProperty(obj, prop, descriptor)
```

| å‚æ•°       | è¯´æ˜                         |
| ---------- | ---------------------------- |
| obj        | éœ€è¦å®šä¹‰å±æ€§çš„å¯¹è±¡           |
| prop       | éœ€è¦å®šä¹‰æˆ–è€…ä¿®æ”¹çš„å±æ€§çš„åå­— |
| descriptor | å°†è¢«å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§çš„æè¿°ç¬¦ |

å…¶ä¸­çš„å±æ€§æè¿°ç¬¦åŒ…å«å¦‚ä¸‹å‡ ç§ï¼š

- configurable
  å½“ä¸”ä»…å½“è¯¥å±æ€§çš„ configurable ä¸º true æ—¶ï¼Œè¯¥å±æ€§æè¿°ç¬¦æ‰èƒ½å¤Ÿè¢«æ”¹å˜ï¼Œä¹Ÿèƒ½å¤Ÿè¢«åˆ é™¤ã€‚é»˜è®¤ä¸º `false`
- enumerable
  å½“ä¸”ä»…å½“è¯¥å±æ€§çš„ enumerable ä¸º true æ—¶ï¼Œè¯¥å±æ€§æ‰èƒ½å¤Ÿå‡ºç°åœ¨å¯¹è±¡çš„æšä¸¾å±æ€§ä¸­ã€‚é»˜è®¤ä¸º `false`ã€‚
- value
  è¯¥å±æ€§å¯¹åº”çš„å€¼ã€‚å¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆçš„ JavaScript å€¼ï¼ˆæ•°å€¼ï¼Œå¯¹è±¡ï¼Œå‡½æ•°ç­‰ï¼‰ã€‚é»˜è®¤ä¸º `undefined`ã€‚
- writable
  å½“ä¸”ä»…å½“è¯¥å±æ€§çš„ writable ä¸º true æ—¶ï¼Œè¯¥å±æ€§æ‰èƒ½è¢«èµ‹å€¼è¿ç®—ç¬¦æ”¹å˜ã€‚é»˜è®¤ä¸º `false`ã€‚
- get
- set

ä¸¾ä¸ª ğŸŒ°ï¼š

```bash
var o = {};

o.a = 1;
// ç­‰åŒäº :
Object.defineProperty(o, "a", {
  value : 1,
  writable : true,
  configurable : true,
  enumerable : true
});


// å¦ä¸€æ–¹é¢ï¼Œ
Object.defineProperty(o, "a", { value : 1 });
// ç­‰åŒäº :
Object.defineProperty(o, "a", {
  value : 1,
  writable : false,
  configurable : false,
  enumerable : false
});

```

### ä½¿ç”¨æ–¹æ³•

é¦–å…ˆåˆ›å»ºä¸ªæµ‹è¯•ç±»ï¼š

```bash
class Duck{
	say(){
		console.log('ga ga ga');
	}
}
```

- ä½œç”¨äºç±»ä¸Š

```bash
@decoratorClass
class Duck{}   //è¯¦ç»†ä»£ç å¦‚ä¸Šæ‰€ç¤º

function decoratorClass(target){
	target.name = "ä½œç”¨äºç±»ä¸Š"
}
```

- ä½œç”¨äºè®¿é—®å™¨

```bash
@decoratorFun
class Duck{}		//ä»£ç åŒä¸Š

function decoratorFun(target,name,descriptor){
	descriptor.writable = false;
	return descriptor;
}

```
